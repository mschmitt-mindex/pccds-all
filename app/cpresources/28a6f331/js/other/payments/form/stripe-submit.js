"use strict";!function(){var e,r,t,n,a,o="#VARIABLES#",i=o.id,c=o.formAnchor,m=o.currencySelector,d=o.amountSelector,u=o.publicKey,f=o.usage,l=document.querySelector('form[data-id="'.concat(c,'"]')),s=!1,v=!1;if(!l||!l.freeform)return console.error("Could not attach payments to Freeform plugin"),!1;l.freeform.setOption("ajax",!0),l.freeform.addOnSubmitCallback(function(r,n){if(l.freeform.lockSubmit(),l.freeform._removeMessages(),!Freeform.paymentsScript)return console.log("Stripe scripts not loaded yet"),l.freeform.unlockSubmit(),!1;if(s)return!0;var a=document.getElementById(i);return"single_use"===f?e.createPaymentMethod("card",t,{}).then(function(e){return e.error?p(e.error.message):(a.value=e.paymentMethod.id,s=!0,void l.freeform.triggerSubmit())}):e.createToken(t).then(function(e){return e.error?p(e.error.message):(a.value=e.token.id,s=!0,void l.freeform.triggerSubmit())}),!1}),l.freeform.addOnAfterAjaxSubmit(function(r,n,a){if(a.actions){var o=document.getElementById(i);a.actions.forEach(function(r){if("stripe.single_payment.payment_intent_action"===r.name){var a=r.metadata.payment_intent;v=!0,o.value=a.id,e.handleCardAction(a.client_secret,t,{}).then(function(e){return e.error?(s=!1,p(e.error.message)):void n.freeform.triggerSubmit()})}if("stripe.subscription.payment_intent_action"===r.name){var i=r.metadata,c=i.subscription,m=i.payment_intent;v=!0,o.value=c.id,e.handleCardPayment(m.client_secret,t,{}).then(function(e){return e.error?(s=!1,p(e.error.message)):void n.freeform.triggerSubmit()})}})}});var p=function(e){return l.freeform._renderFormErrors([e]),l.freeform.unlockSubmit(),!1};l.addEventListener("reset",function(){t&&t.clear(),a&&a.clear(),n&&n.clear()},!1);var y=function(){var o=i+"_card_number",c=i+"_card_cvc",f=i+"_card_expiry",p=document.getElementById(o),y=document.getElementById(c),h=document.getElementById(f),b=p.attributes.placeholder,S=h.attributes.placeholder,E=y.attributes.placeholder,_=g("freeform-stripe-styling");_.detail={},l.dispatchEvent(_);var A=_.detail;e=Stripe(u),r=e.elements(),t=r.create("cardNumber",{placeholder:b?b.value:"",style:A}),n=r.create("cardExpiry",{placeholder:S?S.value:"",style:A}),a=r.create("cardCvc",{placeholder:E?E.value:"",style:A}),t.mount("#"+o),n.mount("#"+f),a.mount("#"+c);var k=function(){s=!1};if(t.on("change",k),n.on("change",k),a.on("change",k),l.freeform.addOnAfterAjaxSubmit(function(){v?v=!1:k()}),d){var B=form.querySelector(d);B&&B.addEventListener("change",k)}if(m){var C=form.querySelector(m);C&&C.addEventListener("change",k)}},g=function(e){var r,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return"function"==typeof Event?r=new Event(e,{bubbles:t,cancelable:n}):(r=document.createEvent("Event"),r.initEvent(e,!0,!0)),r};if(Freeform.paymentsScript)Freeform.paymentsScript.addEventListener("load",y);else{var h=document.createElement("script");h.addEventListener("load",y),h.src="https://js.stripe.com/v3/",document.body.appendChild(h),Freeform.paymentsScript=h}}();